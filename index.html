<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generate URL Debug</title>
    <script>
      document.addEventListener("DOMContentLoaded", function() {
        document.getElementById("url-form").addEventListener("submit", function(event) {
          event.preventDefault(); // Prevent form from submitting and refreshing
          console.log("Form submission prevented"); // Log to verify
          try {
            generateURL();
          } catch (error) {
            console.error("Caught error in generateURL: ", error);
            alert("Caught error: " + error.message);
          }
        });
      });

      function generateURL() {
        console.log("generateURL function called");
        // Log each element to identify which one is causing the issue
        try {
          var elements = ["url", "donationtype", "paymentchannel", "amount1", "amount2", "amount3", "campaign", "narrative1", "narrative2", "narrative3", "adcontent"];
          var values = {};
          
          elements.forEach(function(id) {
            var element = document.getElementById(id);
            if (!element) {
              console.error(`Element with id '${id}' not found`);
              throw new Error(`Element with id '${id}' not found`);
            }
            values[id] = element.value;
          });

          var generatedURL = `${values.url}?donationtype=${values.donationtype}&paymentchannel=${values.paymentchannel}&amount1=${values.amount1}&amount2=${values.amount2}&amount3=${values.amount3}&campaign=${values.campaign}&narrative1=${values.narrative1}&narrative2=${values.narrative2}&narrative3=${values.narrative3}&adcontent=${values.adcontent}`;

          document.getElementById('generatedURL').value = generatedURL;
          console.log("Generated URL: ", generatedURL);
        } catch (error) {
          console.error("Error generating URL: ", error);
          alert("Error generating URL: " + error.message);
        }
      }
    </script>
</head>
<body>

<h2>Generate URL Debug</h2>

<form id="url-form">
    <label for="url">URL:</label>
    <input type="text" id="url" name="url" required>

    <label for="donationtype">Choose Donation Type:</label>
    <select id="donationtype" name="donationtype" required>
        <option value="" disabled selected>Select Donation Type</option>
        <option value="onetime">Single Donation</option>
        <option value="recurring">Regular Donation</option>
    </select>

    <label for="paymentchannel">Payment Channel:</label>
    <select id="paymentchannel" name="paymentchannel" required>
        <option value="" disabled selected>Select Payment Channel</option>
        <option value="newsletter">Newsletter</option>
        <option value="facebook">Facebook</option>
        <option value="instagram">Instagram</option>
        <option value="fieldmarketing">Field Marketing</option>
        <option value="google">Google</option>
        <option value="bing">Bing</option>
        <option value="email">Email</option>
        <option value="youtube">Youtube</option>
        <option value="sms">SMS</option>
        <option value="web">Web</option>
        <option value="directmail">Direct Mail</option>
    </select>

    <label for="campaign">Campaign Name:</label>
    <input type="text" id="campaign" name="campaign" required>

    <label for="amount1">Set Amount 1:</label>
    <input type="number" id="amount1" name="amount1" required>

    <label for="amount2">Set Amount 2:</label>
    <input type="number" id="amount2" name="amount2" required>

    <label for="amount3">Set Amount 3:</label>
    <input type="number" id="amount3" name="amount3" required>

    <label for="narrative1">Narrative 1:</label>
    <input type="text" id="narrative1" name="narrative1" required>

    <label for="narrative2">Narrative 2:</label>
    <input type="text" id="narrative2" name="narrative2" required>

    <label for="narrative3">Narrative 3:</label>
    <input type="text" id="narrative3" name="narrative3" required>

    <label for="adcontent">GA Ad Content:</label>
    <input type="text" id="adcontent" name="adcontent" required>
    
    <input type="submit" value="Generate URL">
</form>

<textarea id="generatedURL" rows="3" readonly></textarea>

</body>
</html>
